<section xml:id="sec_proj_fourier">
  <title>Project: Fourier Series and Musical Tones</title>
  <p>
    Joseph Fourier first studied trigonometric polynomials to understand the flow of heat in metallic plates and rods.
    The resulting series, called Fourier series,
    now have applications in a variety of areas including electrical engineering,
    vibration analysis, acoustics,
    optics, signal processing,
    image processing, geology, quantum mechanics, and many more.
    For our purposes, we will focus on synthesized music.
  </p>
  <p>
    Pure musical tones are periodic sine waves.
    Simple electronic circuits can be designed to generate alternating current.
    Alternating current is current that is periodic,
    and hence is described by a combination of <m>\sin(kx)</m> and
    <m>\cos(kx)</m> for integer values of <m>k</m>.
    To synthesize an instrument like a violin,
    we can project the instrument's tones onto trigonometric polynomials <mdash/> and then we can produce them electronically.
    As we will see,
    these projections are least squares approximations onto certain vector spaces.
    The website \url{http://www.falstad.com/fourier/} provides a tool for hearing sounds digitally created by certain functions.
    For example,
    you can listen to the sound generated by a sawtooth function <m>f</m> of the form
    <me>
      f(x) = \begin{cases}x \amp \text{ if }  -\pi \lt  x \leq \pi, \\ f(x-2\pi),   \amp  \text{ if }  \pi \lt  x, \\ f(x+2\pi),   \amp  \text{ if }  x \leq -\pi. \end{cases}
    </me>
  </p>
  <p>
    Try out some of the tones on this website
    (click on the Sound button to hear the tones).
    You can also alter the tones by clicking on any one of the white dots and moving it up or down. and play with the buttons.
    We will learn much about what this website does in this project.
  </p>
  <p>
    Pure tones are periodic and so are modeled by trigonometric functions.
    In general, trigonometric polynomials can be used to produce good approximations to periodic phenomena.
    A <em>trigonometric polynomial</em><idx><h>trigonometric polynomial</h></idx> is an object of the form
    <md>
      <mrow>c_0 + c_1 \cos(x) + d_1\sin(x) \amp + c_2\cos(2x) + d_2\sin(2x) + \cdots</mrow>
      <mrow>\amp + c_n \cos(nx) + d_n \sin(nx) + \cdots</mrow>
    </md>,
    where the <m>c_i</m> and <m>d_j</m> are real constants.
    With judicious choices of these constants,
    we can approximate periodic and other behavior with trigonometric polynomials.
    The first step for us will be to understand the relationships between the summands of these trigonometric polynomials in the inner product space <m>C[-\pi, \pi]</m><fn>
    With suitable adjustments,
    we can work over any interval that is convenient,
    but for the sake of simplicity in this project,
    we will restrict ourselves to the interval <m>[-\pi, \pi]</m>.
    </fn> of continuous functions from
    <m>[\pi, \pi]</m> to <m>\R</m> with the inner product
    <men xml:id="eq_ip">
      \langle f,g \rangle = \frac{1}{\pi} \int_{-\pi}^{\pi} f(x)g(x) \ dx
    </men>.
  </p>
  <p>
    Our first order of business is to verify that <xref ref="eq_ip"/> is,
    in fact, an inner product.
  </p>
  <activity xml:id="act_Fourier_inner_product">
    <p>
      Let <m>C[a,b]</m> be the set of continuous real-valued functions on the interval <m>[a,b]</m>.
      In <xref ref="ex_6_c_Cab">Exercise</xref>
      in <xref ref="sec_inner_products">Section</xref>
      we are asked to show that <m>C[a,b]</m> is a vector space,
      while <xref ref="ex_6_c_inner_products">Exercise</xref>
      in <xref ref="sec_inner_products">Section</xref> asks us to show that
      <m>\langle f,g \rangle = \int_a^b f(x)g(x) \, dx</m> defines an inner product on <m>C[a,b]</m>.
      However, <xref ref="eq_ip"></xref>
      is slightly different than this inner product.
      Show that any positive scalar multiple of an inner product is an inner product,
      and conclude that <xref ref="eq_ip"/> defines an inner product on <m>C[-\pi,\pi]</m>.
      (We will see why we introduce the factor of <m>\frac{1}{\pi}</m> later.)
    </p>
  </activity>
  <p>
    Now we return to our inner product space
    <m>C[-\pi,\pi]</m> with inner product <xref ref="eq_ip"/>.
    Given a function <m>g</m> in <m>C[-\pi,\pi]</m>,
    we approximate <m>g</m> using only a finite number of the terms in a trigonometric polynomial.
    Let <m>W_n</m> be the subspace of
    <m>C[-\pi,\pi]</m> spanned by the functions
    <me>
      1, \cos(x), \sin(x), \cos(2x), \sin(2x), \ldots, \cos(nx), \sin(nx)
    </me>.
  </p>
  <p>
    One thing we need to know is the dimension of <m>W_n</m>.
  </p>
  <activity xml:id="act_Fourier_W1">
    <p>
      We start with the initial case of <m>W_1</m>.
      <ul>
        <li>
          <p>
            Show directly that the functions <m>1</m>, <m>\cos(x)</m>,
            and <m>\sin(x)</m> are orthogonal.
          </p>
        </li>
        <li>
          <p>
            What is the dimension of <m>W_1</m>?
            Explain.
          </p>
        </li>
      </ul>
    </p>
  </activity>
  <p>
    Now we need to see if what happened in Project <xref ref="act_Fourier_W1">Activity</xref> happens in general.
    A few tables of integrals and some basic facts from trigonometry can help.
  </p>
  <activity xml:id="act_Fourier_Wn">
    <p>
      A table of integrals shows the following for <m>k \neq m</m> (up to a constant):
      <md>
        <mrow xml:id="eq_cos_cos_int" number="yes">\int \cos(mx)\cos(kx) \ dx \amp = \frac{1}{2} \left( \frac{\sin((k-m)x)}{k-m} + \frac{\sin((k+m)x)}{k+m} \right)</mrow>
        <mrow xml:id="eq_sin_sin_int" number="yes">\int \sin(mx)\sin(kx) \ dx \amp = \frac{1}{2} \left( \frac{\sin((k-m)x)}{k-m} - \frac{\sin((k+m)x)}{k+m} \right)</mrow>
        <mrow xml:id="eq_cos_sin_int1" number="yes">\int \cos(mx)\sin(kx) \ dx \amp = \frac{1}{2} \left( \frac{\cos((m-k)x)}{m-k} - \frac{\sin((m+k)x)}{m+k} \right)</mrow>
        <mrow xml:id="eq_cos_sin_int2" number="yes">\int \cos(mx)\sin(mx) \ dx \amp = -\frac{1}{2m} \cos^2(mx)</mrow>
      </md>
      <ul>
        <li>
          <p>
            Use <xref ref="eq_cos_cos_int"/> to show that <m>\cos(mx)</m> and
            <m>\cos(kx)</m> are orthogonal in <m>C[-\pi,\pi]</m> if <m>k \neq m</m>.
          </p>
        </li>
        <li>
          <p>
            Use <xref ref="eq_sin_sin_int"/> to show that <m>\sin(mx)</m> and
            <m>\sin(kx)</m> are orthogonal in <m>C[-\pi,\pi]</m> if <m>k \neq m</m>.
          </p>
        </li>
        <li>
          <p>
            Use <xref ref="eq_cos_sin_int1"/> to show that <m>\cos(mx)</m> and
            <m>\sin(kx)</m> are orthogonal in <m>C[-\pi,\pi]</m> if <m>k \neq m</m>.
          </p>
        </li>
        <li>
          <p>
            Use <xref ref="eq_cos_sin_int2"/> to show that <m>\cos(mx)</m> and
            <m>\sin(mx)</m> are orthogonal in <m>C[-\pi,\pi]</m>.
          </p>
        </li>
        <li>
          <p>
            What is <m>\dim(W_n)</m>?
            Explain.
          </p>
        </li>
      </ul>
    </p>
  </activity>
  <p>
    Once we have an orthogonal basis for <m>W_n</m>,
    we might want to create an orthonormal basis for <m>W_n</m>.
    Throughout the remainder of this project,
    unless otherwise specified,
    you should use a table of integrals or any appropriate technological tool to find integrals for any functions you need.
  </p>
  <activity xml:id="act_Fourier_basis">
    <p>
      Show that the set
      <me>
        \CB_n = \left\{\frac{1}{\sqrt{2}}, \cos(x), \cos(2x), \ldots, \cos(nx), \sin(x), \sin(2x), \ldots, \sin(nx)\right\}
      </me>
      is an orthonormal basis for <m>W_n</m>.
      Use the fact that the norm of a vector <m>\vv</m> in an inner product space with inner product
      <m>\langle \ , \ \rangle</m> is defined to be <m>\sqrt{\langle \vv, \vv \rangle}</m>.
      (This is where the factor of <m>\frac{1}{\pi}</m> will be helpful.)
    </p>
  </activity>
  <p>
    Now we need to recall how to find the best approximation to a vector by a vector in a subspace,
    and apply that idea to approximate an arbitrary function <m>g</m> with a trigonometric polynomial in <m>W_n</m>.
    Recall that the best approximation of a function <m>g</m> in
    <m>C[-\pi,\pi]</m> is the projection of <m>g</m> onto <m>W_n</m>.
    If we have an orthonormal basis
    <m>\{h_0, h_1, h_2, \ldots,
    h_{2n}\}</m> of <m>W_n</m>, then the projection of <m>g</m> onto <m>W_n</m> is
    <me>
      \proj_{W_n} g = \langle g,h_0 \rangle h_0 + \langle g,h_1 \rangle h_1 + \langle g,h_2 \rangle h_2 + \ldots + \langle g,h_{2n} \rangle h_{2n}
    </me>.
  </p>
  <p>
    With this idea,
    we can find formulas for the coefficients when we project an arbitrary function onto <m>W_n</m>.
  </p>
  <activity xml:id="act_Fourier_projection">
    <p>
      If <m>g</m> is an arbitrary function in <m>C[-\pi,\pi]</m>,
      we will write the projection of <m>g</m> onto <m>W_n</m> as
      <md>
        <mrow>a_0\left(\frac{1}{\sqrt{2}}\right) + a_1 \cos(x) + b_1\sin(x) + a_2 \cos(2x) \amp + b_2 \sin(2x) + \cdots</mrow>
        <mrow>\amp + a_n \cos(nx) + b_n \sin(nx)</mrow>
      </md>.
    </p>
    <p>
      The <m>a_i</m> and <m>b_j</m> are the
      <em>Fourier coefficients</em>
          <idx><h>Fourier coefficients</h></idx>
      for <m>f</m>.
      The expression <m>a_n\cos(nx)+b_n\sin(nx)</m> is called the <m>n</m>th
      <em>harmonic</em> of <m>g</m>.
      The first harmonic is called the
      <em>fundamental frequency</em>.
      The human ear cannot hear tones whose frequencies exceed 20000 Hz, so we only hear finitely many harmonics
      (the projections onto <m>W_n</m> for some <m>n</m>).
      <ul>
        <li>
          <p>
            Show that
            <men xml:id="eq_a0">
              a_0 =  \frac{1}{\sqrt{2}\pi}\int_{-\pi}^{\pi} g(x) \ dx
            </men>.
            Explain why <m>\frac{a_0}{\sqrt{2}}</m> gives the average value of <m>g</m> on <m>[-\pi,\pi]</m>.
            You may want to go back and review average value from calculus.
            This is saying that the best constant approximation of <m>g</m> on
            <m>[-\pi,\pi]</m> is its average value, which makes sense.
          </p>
        </li>
        <li>
          <p>
            Show that for <m>m \geq 1</m>,
            <men xml:id="eq_am">
              a_m =  \frac{1}{\pi}\int_{-\pi}^{\pi} g(x) \cos(mx) \ dx
            </men>.
          </p>
        </li>
        <li>
          <p>
            Show that for <m>m \geq 1</m>,
            <men xml:id="eq_bm">
              b_m =  \frac{1}{\pi}\int_{-\pi}^{\pi} g(x) \sin(mx) \ dx
            </men>.
          </p>
        </li>
      </ul>
    </p>
  </activity>
  <p>
    Let us return to the sawtooth function defined earlier and find its Fourier coefficients.
  </p>
  <activity xml:id="act_Fourier_sawtooth">
    <p>
      Let <m>f</m> be defined by <m>f(x) = x</m> on
      <m>[-\pi,\pi]</m> and repeated periodically afterwards with period <m>2\pi</m>.
      Let <m>p_n</m> be the projection of <m>f</m> onto <m>W_n</m>.
      <ul>
        <li>
          <p>
            Evaluate the integrals to find the projection <m>p_1</m>.
          </p>
        </li>
        <li>
          <p>
            Use appropriate technology to find the projections <m>p_{10}</m>,
            <m>p_{20}</m>,
            and <m>p_{30}</m> for the sawtooth function <m>f</m>.
            Draw pictures of these approximations against <m>f</m> and explain what you see.
          </p>
        </li>
        <li>
          <p>
            Now we find formulas for all the Fourier coefficients.
            Use the fact that <m>x \cos(mx)</m> is an odd function to explain why <m>a_m = 0</m> for each <m>m</m>.
            Then show that <m>b_m = (-1)^{m+1}\frac{2}{m}</m> for each <m>m</m>.
          </p>
        </li>
        <li>
          <p>
            Go back to the website \url{http://www.falstad.com/fourier/} and replay the sawtooth tone.
            Explain what the white buttons represent.
          </p>
        </li>
      </ul>
    </p>
  </activity>
  <activity xml:id="act_Fourier_square_sums">
    <p>
      This activity is not connected to the idea of musical tones,
      so can be safely ignored if so desired.
      We conclude with a derivation of a very fascinating formula that you may have seen for <m>\ds \sum_{n=1}^{\infty} \frac{1}{n^2}</m>.
      To do so, we need to analyze the error in approximating a function <m>g</m> with a function in <m>W_n</m>.
    </p>
    <p>
      Let <m>p_n</m> be the projection of <m>g</m> onto <m>W_n</m>.
      Notice that <m>p_n</m> is also in <m>W_{n+1}</m>.
      It is beyond the scope of this project, but in
      <q>nice</q>
      situations we have <m>||g - p_n|| \to 0</m> as <m>n \to \infty</m>.
      Now <m>g - p_n</m> is orthogonal to <m>p_n</m>,
      so the Pythagorean theorem shows that
      <me>
        ||g-p_n||^2 + ||p_n||^2 = ||g||^2
      </me>.
    </p>
    <p>
      Since <m>||g-p_n||^2 \to 0</m> as
      <m>n \to \infty</m>, we can conclude that
      <men xml:id="eq_Fourier_norm">
        \lim_{n \to \infty} ||p_n||^2 = ||g||^2
      </men>.
    </p>
    <p>
      We use these ideas to derive a formula for <m>\ds \sum_{n=1}^{\infty} \frac{1}{n^2}</m>.
      <ul>
        <li>
          <p>
            Use the fact that <m>\CB_n</m> is an orthonormal basis to show that
            <me>
              ||p_n||^2 = a_0^2 +a_1^2 + b_1^2 + \cdots + a_n^2 + b_n^2
            </me>.
            Conclude that
            <men xml:id="eq_norms">
              ||g||^2 = a_0^2 +a_1^2 + b_1^2 + \cdots + a_n^2 + b_n^2 + \cdots
            </men>.
          </p>
        </li>
        <li>
          <p>
            For the remainder of this activity,
            let <m>f</m> be the sawtooth function defined by <m>f(x) = x</m> on
            <m>[-\pi,\pi]</m> and repeated periodically afterwards.
            We determined the Fourier coefficients <m>a_i</m> and <m>b_j</m> of this function in Project <xref ref="act_Fourier_sawtooth">Activity</xref>.
            <ol>
              <li>
                <title>i</title>
                <p>
                  Show that
                  <me>
                    a_0^2 +a_1^2 + b_1^2 + \cdots + a_n^2 + b_n^2 + \cdots = 4\sum_{n=1}^{\infty} \frac{1}{n^2}
                  </me>.
                </p>
              </li>
              <li>
                <title>ii</title>
                <p>
                  Calculate <m>||f||^2</m> using the inner product and compare to <xref ref="eq_norms"/> to find a surprising formula for <m>\sum_{n=1}^{\infty} \frac{1}{n^2}</m>.
                </p>
              </li>
            </ol>
          </p>
        </li>
      </ul>
    </p>
  </activity>
</section>